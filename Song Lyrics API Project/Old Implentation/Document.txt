This is the old version of the implementation of this program
